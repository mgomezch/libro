
\chapter{Desarrollo}

\thispagestyle{empty} 

A continuación, se expone detalladamente el proceso de desarrollo
del sistema. Se describe, de manera amplia y específica, cada una
de las actividades programadas para cada una de las fases del proyecto,
haciendo énfasis en los aspectos importantes, tanto de diseño, como
de implementación, además de detalles técnicos de interés. Esta exposición
está estructurada en base a las fases definidas en el marco metodológico. 


\section{Inicio}

En esta fase, se debe determinar los requerimientos específicos que
formarán parte del sistema, por lo tanto, es imprescindible que las
primeras actividades estén relacionadas a la familiarización con los
conceptos y actividades manejados en la empresa, qué procesos se siguen
para la realización de las actividades y operaciones a atender, y
los recursos con los que se cuenta en la actualidad. También, es de
interés determinar qué efecto genera el desarrollo del proyecto en
las actividades de la empresa. Esta fase se ejecutó en una sola iteración.


\subsection{Estudio de los sistemas existentes en la empresa.}

Esta actividad es de gran importancia, pues permite conocer, tanto
de manera técnica, como operacional, qué procesos se atienden en la
empresa y si alguno de éstos es de interés para formar parte o trabajar
en conjunto con las actividades que se desarrollan en el proyecto.
Sabiendo ésto, se decide evaluar los sistemas que, a juicio de la
empresa, deben interactuar con la aplicación a desarrollar.

En la empresa, se encuentrar implantados dos sistemas básicos que
atienden dos procesos importantes para el negocio de la misma:
\begin{itemize}
\item En el entorno de Venelab, se encuentra en funcionamiento un sistema
de Gestión de Citas de Laboratorio, encargado manejar las operaciones
de solicitud de citas, permitiendo a los usuarios conocer los horarios
disponibles y hacer citas vía web.
\item En el entorno de Venemergencia, se tiene desarrollado un sistema de
Gestión de Ambulancias, que permite el control de las unidades, dando
información sobre el estado de las mismas, si están operativas o no,
además de dar información al operador de la aplicación si existen
solicitudes de traslados activos, en espera.
\end{itemize}
\begin{onehalfspace}
~
\end{onehalfspace}

Para los objetivos de la aplicación de gestión de consultas médicas,
a desarrollar en este proyecto de pasantías, se determinó que sólo
era relevante la interacción con el sistema de solicitud de citas
de laboratorio, Venelab, para permitir realizar solicitudes de citas
para la realización de exámenes, en las instalaciones de la empresa.

En un principio, se concibió interacción directa con este sistema,
en la que el usuario pudiera realizar las operaciones que se podían
ejecutar a través del sistema de citas de laboratorio, utilizando
el sistema de consultas médicas, sin embargo, debido a decisiones
de negocio y usabilidad, esta primera aproximación a lo que se debía
realizar, fue reconsiderada. 

Primordialmente, este cambio se debe a dos condiciones:
\begin{itemize}
\item Primero, por cuestión de practicidad, concibiendo en el nuevo sistema
de consultas médicas como primordial la mejora del uso del tiempo
en la atención de consultas, hacer que el médico deba realizar tareas
de concertación de citas y verificación de horarios era poco acertado. 
\item También, se está planificando una reestructuración de los sistemas
empleados para la gestión de las actividades de gestión de citas de
laboratorio, por lo tanto, invertir tiempo en una posible aplicación
a ser descartada o modificada se consideró inconveniente.
\end{itemize}

\subsection{Revisión inicial de los requerimientos del sistema.}

En conjunto con los directores de Venemergencia y Venetecnología,
se determinaron las primeras necesidades que debe atender la aplicación.
Es vital definir que requerimientos funcionales debe cubrir el sistema. 

Las necesidades detectadas en esta actividad representan la visión
inicial del sistema. Ésta se profundiza en el Documento Visión del
Sistema, anexo en el Apéndice \ref{chap:Documento-Visi=0000F3n}.

Se requiere una aplicación web que permita a los médicos gestionar
consultas médicas de sus pacientes. El objetivo principal de la aplicación,
es agilizar y mejorar los tiempos de realización de consultas médicas.
También, es importante la recolección de la información de las consultas
médicas realizadas, de forma persistente, lo que permitirá a los médicos
tener a la mano todo el historial clínico del paciente.

La finalidad de que esta aplicación sea realizada en un ambiente web,
es simplificar el acceso, tanto a médicos como pacientes, de la misma,
evitando inconvenientes de instalación y configuración, que no son
necesarios, pues sólo se requiere de un navegador para acceder a la
misma.

Esta aplicación debe permitir el registro de antecedentes y hábitos
de los pacientes, con la finalidad de mantener éstos como un registro
permanente y actualizable, que permita a los médicos evitar la solicitud
de información conocida en pacientes que ya han sido atendidos con
el sistema.

Es fundamental, el desarrollo de un módulo de gestión de pacientes,
que permita agregarlos al sistema, y que a su vez, los pacientes sean
usuarios del sistema, para que puedan acceder a los resúmenes de las
consultas propias y descargarlos o imprimirlos desde cualquier lugar
con acceso a internet. También es importante que se pueda gestionar
usuarios médico-administrativos a la aplicación, que son los que la
utilizarán para creación de consultas y desarrollo de otras tareas.

Uno de los requerimientos que se solicitó, es que se definiera un
sistema de permisologías por tipo de usuario, que habilite ciertas
operaciones y bloquee otras, dependiendo del usuario que accede a
la aplicación.

También es necesario permitir el registro de resultados de exámenes
médicos, funcionales, físicos y paraclínicos, para asociarlos a una
consulta.

Otro de los requerimientos es la generación de documentos imprimibles
para informes médicos de las consultas y para las interconsultas solicitadas,
con la información del paciente y los datos de las consultas automáticamente
cargada en los mismos, para agilizar esta tarea, que actualmente es
realizada a mano en un procesador de texto.

Por último, es importante establecer un medio para solicitar citas
de laboratorio, en la empresa Venelab.


\subsection{Familiarización con los conceptos del negocio.}

En esta etapa, era importante conocer qué conceptos se manejaban en
la empresa, que formaban parte de las necesidades requeridas para
la aplicación. Esto se realizó mediante reuniones con los médicos
y directores de Venemergencia A.G., en las que se aclararon muchos
de los conceptos y dudas existentes sobre ellos. Gran parte de estos
conceptos, están definidos en la sección de Conceptos Básicos, presente
en el marco teórico.


\subsection{Definición de las tecnologías y herramientas a utilizar para el desarrollo
del proyecto.}

Para el desarrollo de este proyecto, se buscó utilizar tecnologías
que cumplieran con las siguientes características:
\begin{enumerate}
\item Ser tecnologías con una curva de aprendizaje que no retrasara en gran
medida los plazos establecidos para el desarrollo de las actividades,
en vista de la duración de veinte (20) semanas del proyecto de pasantías.
\item Que permitan el funcionamiento del sistema a desarrollar en ambientes
multiplataforma.
\item Ser tecnologías que, en la medida de lo posible, simplifiquen el trabajo
del programador, abstrayendo tareas repetitivas mediante funciones
de alto nivel.
\item La existencia de una comunidad de desarrolladores, dedicada al mantenimiento
y mejora de la misma, con el objetivo de resolver problemas y errores
del mismo y agregar nuevas características, para garantizar la mantenibilidad
y extensibilidad del software desarrollado.
\item Ser tecnologías que posean esquemas de licencias libres.
\end{enumerate}
~

En base a estos parámetros, se decide emplear las siguientes tecnologías:
\begin{itemize}
\item \textbf{MySQL:} Manejador de bases de datos (\textit{database management
system} o DBMS) relacional, multihilo y multiusuario, propiedad de
Sun Microsystems, que a su vez es propiedad de Oracle Corporation,
``caracterizado por su alto rendimiento, confiabilidad y facilidad
de uso''~\cite{MYSQL}. Es multiplataforma, lo que garantiza su
operatividad en gran cantidad de sistemas y equipos, y además, ofrece
gran cantidad de herramientas, y al ser uno de los DBMS más utilizados,
tiene una gran comunidad que proporciona soporte para su uso. MySQL
se desarrolla como software libre en un esquema de licenciamiento
dual, existiendo tanto un esquema de licenciamiento GNU GPL, como
un licenciamiento privativo.
\item \textbf{CakePHP 1.3:} \textit{framework} de PHP libre, de código abierto,
destinado al desarrollo de aplicaciones Web de manera rápida. Se caracteriza
por su fácil instalación, bajos requerimientos de configuración. Sigue
una arquitectura MVC, es compatible con PHP4 y PHP5. Simplifica las
tareas de conexión con la base de datos, y facilita las consultas,
mediante el uso de funciones de alto nivel, que además, proveen aspectos
de seguridad (como protección contra Inyección SQL o \textit{SQL Injection}).
También, posee una comunidad activa, que desarrolla continuamente
nuevas extensiones para simplificar tareas de uso común. El framework
CakePHP ``puede manejar cualquier aspecto, desde la solicitud inicial
del usuario hasta el renderizado final de la página web''~\cite{PrincipiosCake}.
\item \textbf{Apache Web Server:} servidor web HTTP de código abierto, multiplataforma,
utilizado para ejecutar las pruebas de la aplicación. Se empleó XAMPP,
una aplicación de sencilla configuración, para instalar MySQL, Apache,
PHP en cualquier plataforma.
\item \textbf{Manejo de control de versiones Mercurial:} empleado para mantener
un control sobre los avances del desarrollo de la aplicación, manteniendo,
además, un respaldo de los archivos, en caso de ocurrir algún problema
de pérdida de datos, o errores en la aplicación. Para el manejo de
versiones, se utilizó el servicio de alojamiento basado en web, Bitbucket.
\item \textbf{jQuery:} es una librería de Javascript, que se emplea para
``simplificar la interacción con elementos HTML, manejo de eventos,
desarrollo de animaciones''~\cite{jQuery} y utilización de AJAX
para la comunicación asíncrona con el servidor. Ofrece funcionalidades
de Javascript, que de ser desarrolladas sin el uso de estas librerías,
requieren mucho más código, por lo que facilita el desarrollo al programador,
y le ahorra tiempo. jQuery es software libre y de código abierto,
basado en la licencia MIT y GNU GPL.
\end{itemize}

\section{Elaboración}

En esta fase, una de las actividades más importantes a realizar consiste
en refinar los requerimientos del sistema, a partir de la construcción
de documentos formales que contengan especificados cada una de las
funcionalidades que debe ejecutar el mismo. Ésto permite determinar
el alcance real del proyecto. Esta fase se desarrolló en una sola
iteración. A continuación, se presentan las actividades desarrolladas
en la fase de \textsl{Elaboración}.


\subsection{Formalización y refinamiento de los requerimientos funcionales del
sistema}

A través de la construcción del documento ERS, se especificó detalladamente
cada uno de los requerimientos de manera formal. En este documento
también se encuentran plasmados los casos de uso asociados a cada
uno de los requerimientos funcionales. En definitiva, este muestra
qué acciones y tareas deben poderse realizar con el sistema al final
de su desarrollo. En el Apéndice \ref{chap:Especificaci=0000F3n-de-Requerimientos},
se detalla el documento de Especificación de Requerimientos de Software
generado.

Se definieron diez (10) requerimientos funcionales para la aplicación
de gestión de consultas médicas. Los requerimientos funcionales deteminados
en esta fase son:
\begin{itemize}
\item Registrar pacientes en el sistema.
\item Guardar Historial de Consultas Médicas para cada paciente.
\item Generar reportes estadísticos de patologías recurrentes.
\item Prescribir medicamentos a los pacientes.
\item Registrar información de exámenes médicos y de laboratorio.
\item Permitir solicitud de citas de laboratorio en Venelab, desde una consulta
en desarrollo. 
\item Generar reportes de consultas médicas.
\item Generar Interconsulta.
\item Añadir antecedentes médicos de los pacientes.
\item Registrar Médicos en el Sistema.
\end{itemize}
~

Al conocerse estos requerimientos, se determinó los casos de uso a
implementar, para hacer efectivo el cumplimiento de los mismos. Se
determinaron veinte (20) casos de uso a implementar. A continuación,
en la Figura 4.1, se muestra un diagrama de casos de uso, con cada
uno de los usuarios del sistema y las funcionalidades con las que
están relacionados.

\begin{center}
\begin{figure}[h]
\begin{centering}
\includegraphics[scale=0.32]{CasosUsoSistema2}
\par\end{centering}

\caption{Diagrama de Casos de Uso del Sistema.}


\end{figure}

\par\end{center}


\subsection{Definición de los componentes y subcomponentes del sistema}

En esta etapa, se debe determinar la estructura de la aplicación.
En base a los requerimientos formales definidos, se determina que
los componentes del sistema son:
\begin{itemize}
\item \textbf{Módulo para gestión de pacientes:} Integra todas las operaciones
de creación, modificación y gestión de pacientes.
\item \textbf{Módulo para gestión de usuarios médico-administrativos:} Integra
todas las operaciones de creación, modificación y gestión de usuarios
del sistema.
\item \textbf{Módulo para gestión de consultas médicas:} Incluye todo lo
relacionado al inicio y la gestión de una consulta médica, y a la
visualización y/o edición de consultas médicas previamente existentes.
\item \textbf{Módulo para visualización de reportes sobre patologías recurrentes:}
Corresponde a las operaciones para visualizar gráficamente reportes
acerca de las patologías recurrentes en las consultas médicas.
\end{itemize}
~


\subsection{Diseño y elaboración del Modelo de Datos del sistema}

El sistema debe interactuar con la aplicación de consultas médicas,
vía celular, ContactaMed, por lo tanto, se realizó un diseño en conjunto
del modelo de datos a utilizar para ambas aplicaciones. 

En principio, se contaba con un modelo de datos básico, que recogía
la información básica de una consulta médica y su asociación con los
pacientes. En MySQL, existía un modelo de datos, con las tablas \textsl{consultas},
\textsl{paciente}, \textsl{habitos}, \textsl{antecedentes\_medicos}.
Este modelo de datos debió ampliarse para permitir registrar con mayor
detalle la información requerida en una consulta médica.

Se agregaron nuevas tablas para contener la información específica
sobre los exámenes, servicios, diagnósticos, interconsultas y toda
la información relevante en la consulta. Las tablas incorporadas son:
\textsl{antecedentes\_medicos}, \textsl{archivos\_paraclinicos}, \textsl{atiende\_pacientes},
\textsl{consultas}, \textsl{consulta\_tipos}, \textsl{diagnosticos},
\textsl{diagnosticos\_lista}, \textsl{especialidades}, \textsl{examenes\_fisicos},
\textsl{examenes\_funcionales}, \textsl{examenes\_paraclinicos}, \textsl{habitos},
\textsl{interconsultas}, \textsl{paciente}, \textsl{pasos\_finales},
\textsl{perfiles\_solicitados}, \textsl{servicios}, \textsl{tipo\_diagnostico},
\textsl{tratamientos}, \textsl{tratamientos\_lista}, \textsl{usuario\_datos}.
Además, se incorporaron tablas para representar los diferentes tipos
de usuario (\textsl{groups}); el esquema de Lista de Control de Acceso
(\textsl{Access Control List} o ACL) con las tablas\textsl{ acos},
\textsl{aros}, \textsl{aros\_acos}; y los datos de sesión de usuario
de forma separada a los datos personales utilizando la tabla \textsl{sesion\_usuarios}.
En total, se agregaron veinticinco (25) tablas al modelo de datos
previo.

Estas nuevas tablas se incorporaron al modelo de datos, algunas bajo
una concepción inicial del sistema, y otras que fueron identificadas
como necesarias a medida que se iban necesitando, en el desarrollo
de cada una de las iteraciones de la fase de Construcción.

A continuación, se presenta una tabla con cada una de las entidades
del modelo de datos y su descripción (Cuadro 4.1).

\begin{center}
\begin{table}[h]
\caption{Entidades del modelo de datos del sistema.}
\end{table}
\begin{longtable}{|c|>{\centering}p{11cm}|}
\hline 
\textbf{\footnotesize Modelo} & \textbf{\footnotesize Descripción}\tabularnewline
\hline 
\endfirsthead
\hline 
\textbf{\footnotesize Modelo} & \textbf{\footnotesize Descripción}\tabularnewline
\hline 
\endhead
\hline 
{\footnotesize acos} & {\footnotesize Representa los objetos que se quieren controlar por
los usuarios, es decir, las operaciones que se pueden ejecutar en
el sistema.}\tabularnewline
\hline 
{\footnotesize antecedentes\_medicos} & {\footnotesize Representa la información de antecedentes médicos de
un paciente.}\tabularnewline
\hline 
{\footnotesize archivos\_paraclinicos} & {\footnotesize Representa los archivos que se cargan en una consulta.}\tabularnewline
\hline 
{\footnotesize aros} & {\footnotesize Representa los objetos que requieren el control de
alguna operación del sistema, o usuarios.}\tabularnewline
\hline 
{\footnotesize aros\_acos} & {\footnotesize Relación entre objetos acos y aros, define que permisos
tienen los usuarios sobre las operaciones.}\tabularnewline
\hline 
{\footnotesize atiende\_pacientes} & {\footnotesize Representa la relación entre un paciente y un médico
que lo atiende.}\tabularnewline
\hline 
{\footnotesize consultas} & {\footnotesize Representa la información básica de una consulta médica.}\tabularnewline
\hline 
{\footnotesize consulta\_tipos} & {\footnotesize Representa los tipos de consulta realizables mediante
el sistema.}\tabularnewline
\hline 
{\footnotesize diagnosticos} & {\footnotesize Representa los diagnósticos determinados en una consulta
de un paciente.}\tabularnewline
\hline 
{\footnotesize diagnosticos\_lista} & {\footnotesize Representa la lista de posibles diagnósticos asignables
en una consulta a un paciente.}\tabularnewline
\hline 
{\footnotesize especialidades} & {\footnotesize Representa la lista de especialidades que un médico
puede desempeñar.}\tabularnewline
\hline 
{\footnotesize examenes\_fisicos} & {\footnotesize Representa un examen físico asociado a una consulta.}\tabularnewline
\hline 
{\footnotesize examenes\_funcionales} & {\footnotesize Representa un examen funcional asociado a una consulta.}\tabularnewline
\hline 
{\footnotesize examenes\_paraclinicos} & {\footnotesize Representa un examen paraclínico asociado a una consulta.}\tabularnewline
\hline 
{\footnotesize groups} & {\footnotesize Representa la lista tipos de usuarios disponibles en
el sistema.}\tabularnewline
\hline 
{\footnotesize habitos} & {\footnotesize Representa los hábitos asociados a un paciente.}\tabularnewline
\hline 
{\footnotesize interconsultas} & {\footnotesize Representa las interconsultas solicitadas a un paciente
en una consulta.}\tabularnewline
\hline 
{\footnotesize paciente} & {\footnotesize Representa los datos personales de un paciente registrado
en el sistema.}\tabularnewline
\hline 
{\footnotesize pasos\_finales} & {\footnotesize Representa la información de cierre de consulta, conteniendo
reposos, recomendaciones y conclusiones.}\tabularnewline
\hline 
{\footnotesize perfiles\_solicitados} & {\footnotesize Representa los exámenes y perfiles de laboratorio solicitados
para ser realizados en Venelab.}\tabularnewline
\hline 
{\footnotesize servicios} & {\footnotesize Representa los servicios prestados al paciente durante
una consulta.}\tabularnewline
\hline 
{\footnotesize sesion\_usuarios} & {\footnotesize Representa los datos de inicio de sesión de un usuario
del sistema.}\tabularnewline
\hline 
{\footnotesize tipo\_diagnostico} & {\footnotesize Representa la lista de los sistemas físicos a los que
pertenecen los diagnósticos.}\tabularnewline
\hline 
{\footnotesize tratamientos} & {\footnotesize Representa los tratamientos indicados a un paciente
en una consulta.}\tabularnewline
\hline 
{\footnotesize tratamientos\_lista} & {\footnotesize Representa la lista de tratamientos que pueden ser
indicados a los pacientes.}\tabularnewline
\hline 
{\footnotesize usuario\_datos} & {\footnotesize Representa los datos personales de los usuarios del
sistema que no son pacientes.}\tabularnewline
\hline 
\end{longtable}
\par\end{center}

En el Apéndice \ref{chap:Modelo-de-Datos}, se muestra el diagrama
Entidad - Relación del Sistema, detallando cada una de las tablas
y sus atributos.


\subsection{Adiestramiento en las herramientas de programación.}

Se dedicó tiempo al adiestramiento y aprendizaje de las herramientas
y tecnologías a emplear en el desarrollo del sistema, especialmente
en las siguientes tecnologías:


\subsubsection{Adiestramiento en PHP.}

Inicialmente, no se había determinado el uso de un \textsl{framework}
en la aplicación para aligerar la carga sobre el desarrollador, por
lo que se invirtió tiempo en la utilización de PHP como lenguaje a
nivel del servidor para desarrollar la lógica de la aplicación. Se
utilizaron los manuales y la documentación existentes en la página
oficial de PHP. Luego, al decidirse utilizar un \textsl{framework},
esta preparación fue de utilidad, debido a que se seleccionó CakePHP,
basado en PHP, lo que permitió el conocimiento de las funciones y
operaciones disponibles en el lenguaje, facilitando la adaptación
al mismo.


\subsubsection{Adiestramiento en CakePHP.}

Después de determinar la utilización de este framework, se dedicó
parte del tiempo en el aprendizaje de la filosofía de CakePHP, y el
uso de las facilidades que provee al desarrollador. Se empleó para
esta labor la documentación presente en el sitio oficial de CakePHP~\cite{Cake1.3Api}
y el Libro de Recetas (\textsl{Cookbook}) de CakePHP~\cite{Cookbook},
también disponible en el sitio. 


\subsubsection{Adiestramiento con jQuery.}

Se decidió utilizar jQuery, \textsl{framework} de Javascript, debido
a la gran cantidad de scripts a desarrollar para las funcionalidades
asíncronas al utilizar la técnica AJAX, además, para la generación
de contenidos dinámicamente, que mediante Javascript solamente, sería
más complicado y requeríria mucho mayor tiempo de programación. Se
empleó la documentación de jQuery existente en el sitio oficial de
la herramienta.


\section{Construcción}

Esta fase comprendió casi la totalidad del desarrollo del proyecto
de pasantías. En ésta, se inicia la implementación de los casos de
uso definidos en la fase de Elaboración. Por utilizarse una metodología
como AUP, esta fase se desarrolló de manera iterativa, produciendo
versiones parciales funcionales de cada una de las operaciones descritas
para el sistema.

Se dividió en tres iteraciones, correspondientes a cada uno de los
componentes principales de la aplicación. La construcción se llevó
a cabo de la siguiente manera:


\subsection{Primera Iteración: Gestión de Usuarios del Sistema}

Esta iteración se enfoca en todas las actividades relacionadas al
manejo de usuarios en el sistema, su creación, modificación y permisos
de acceso. 


\subsubsection{Diseño e implementación de módulo de registro de pacientes.}

Se requiere la gestión de pacientes, los usuarios que serán consultados
por los médicos, por lo tanto era primordial el diseño de un módulo
que permitiera el ingreso de nuevos pacientes al sistema. Se diseñó
un formulario que recogiera la información de pacientes, que ya estaba
determinada en el modelo de datos preexistente. La información solicitada
corresponde a: cédula, nombres, apellidos, teléfonos, correo electrónico,
sexo, tipo de sangre, lateralidad (diestro, zurdo, ambidiestro). Se
diseñaron dos plantillas similares, una para el personal médico, que
requiera registrar un paciente que no esté presente en el sistema,
y la otra para el uso de pacientes, que quieran registrarse a si mismos
como usuarios. La diferencia entre ambas plantillas está en que al
registrarse uno mismo, tiene la posibilidad de seleccionar su contraseña
de ingreso, pero al ser registrado por un usuario médico-administrativo,
se le asigna una contraseña automáticamente, la cual podrá ser modificada
por el propio paciente, si así lo desea.

En la Figura 4.2 se muestra una captura del formulario de registro
de pacientes, para médicos. Véase que no se solicita la contraseña
del usuario a registrar.

\begin{center}
\begin{figure}[h]
\begin{centering}
\includegraphics[scale=0.3]{\string"Imagenes Expo/RegistroPacienteMedico\string".eps}\caption{Formulario de Registro de Pacientes por el Médico.}

\par\end{centering}

\end{figure}

\par\end{center}

En la Figura 4.3 se muestra una captura del formulario de registro
de pacientes, por el mismo paciente. Véase que A diferencia de la
Figura 4.2, se solicita la contraseña del usuario a registrar.

\begin{center}
\begin{figure}[h]
\centering{}\includegraphics[scale=0.27]{\string"Imagenes Expo/RegistroPacientes\string".eps}\caption{Formulario de Registro de Pacientes por el mismo usuario.}
\end{figure}

\par\end{center}


\subsubsection{Diseño e implementación de módulo de registro de usuarios médicos
y administrativos.}

El sistema requiere el registro de usuarios médico-administrativos
del sistema. A diferencia de los pacientes, que pueden registrarse
ellos mismos, estos usuarios deben ser registrados por un Administrador
del sistema. Sin embargo, la planilla diseñada para recolectar los
datos es similar a la utilizada para la creación de pacientes.

Se registra la siguiente información sobre cada usuario: cédula, nombres,
apellidos, teléfonos, correo electrónico, nombre de usuario, tipo
de usuario, número de sanidad e inpsasel, estos últimos solo si aplican
para el tipo de usuario.

En la Figura 4.4 se muestra una captura del formulario de registro
de pacientes. Véase que el formulario permite el ingreso de un nombre
de usuario o Login para el mismo.

\begin{center}
\begin{figure}[h]
\begin{centering}
\includegraphics[scale=0.3]{\string"Imagenes Expo/RegistroUsuarios\string".eps}\caption{Formulario de Registro de Usuarios Médico-Administrativos.}

\par\end{centering}

\end{figure}

\par\end{center}


\subsubsection{Desarrollo de módulo de gestión de pacientes y usuarios médico-administrativos.}

La información de los usuarios del sistema debe ser editable, por
lo tanto, se diseñaron operaciones para la modificación de estos datos.
Se desarrolló un formulario para búsqueda de pacientes, que permite
filtrarlos basado en su información personal.

A continuación, se presenta el formulario de búsqueda de pacientes
(Figura 4.5).

\begin{center}
\begin{figure}[h]
\centering{}\includegraphics[scale=0.3]{img/BusquedaPaciente}\caption{Formulario de Búsqueda de Pacientes.}
\end{figure}

\par\end{center}

En la figura 4.6, se muestra el formulario de edición de datos de
usuario.

\begin{center}
\begin{figure}[h]
\centering{}\includegraphics[scale=0.3]{\string"Imagenes Expo/EdicionUsuarios\string".eps}\caption{Formulario de Edición de Datos de Usuario.}
\end{figure}

\par\end{center}


\subsubsection{Módulo de inicio de sesión de usuarios.}

Se diseñó un módulo de inicio de sesión de usuarios, en el cual, todos
los tipos de usuarios ingresaran de la misma manera. Se diseñó un
formulario sencillo de ingreso de nombre de usuario y contraseña.
Para los pacientes, su nombre de usuario coincide con su número de
cédula de identidad, para los demás tipos de usuario, se refiere a
una secuencia de caracteres alfanumérica, con al menos un caracter
alfabético.

Al ingresar los datos, se verifica si el nombre de usuario y la contraseña
coinciden con los datos presentes en la tabla \textsl{sesion\_usuarios}.
La contraseña se encuentra cifrada a nivel de base de datos. Este
cifrado se realiza mediante el algoritmo de SHA-1, con sal (\textsl{salt}),
este término se refiere al uso de un conjunto de bits aleatorios,
utilizados como valor de inicialización, que se concatenan con la
contraseña seleccionada antes de aplicar el cifrado con SHA-1; el
componente \textsl{Auth} de CakePHP realiza esta tarea automáticamente. 

Para cada conjunto de usuarios, se definen diferentes vistas dependiendo
de los permisos que se le concede, según su tipo. Al ingresar, se
le da acceso a las funcionalidades que tiene permitidas. Existen grupos
de usuarios que, actualmente no poseen permisos para ninguna acción
más que la de ingresar al sistema (Enfermero, Paramédico, Recepcionista),
pero se espera que, a futuro, jueguen un papel activo en la aplicación.

En la Figura 4.7, se presenta la pantalla de inicio de sesión para
usuarios del Sistema.

\begin{center}
\begin{figure}[h]
\centering{}\includegraphics[scale=0.35]{img/InicioSesion}\caption{Ventana de Inicio de Sesión del Sistema.}
\end{figure}

\par\end{center}


\subsubsection{Establecimiento del sistema de Listas de Control de Acceso (\textit{Access
Control Lists})}

Luego de garantizar la creación e inicio de sesión de los usuarios,
se procedió a generar es sistema de gestión de permisos de acciones,
mediante la implementación del sistema de Listas de Control de Acceso
(ACL, por sus siglas en inglés). Este sistema está integrado a CakePHP,
con el uso del componente ACL. 

CakePHP permite utilizar este componente mediante dos implementaciones,
una basada en un archivo de configuración INI, y otra basada en tablas
de la base de datos. El primer modo es recomendable para aplicaciones
sencillas que probablemente no requieran utilizar una base de datos.
El segundo, es el recomendado por los desarrolladores de CakePHP,
por permitir la creación de nuevos recursos y usuarios de los mismos,
desde la aplicación.

Para la aplicación a desarrollar, se escogió el esquema basado en
la base de datos.

Se utiliza creando unas tablas en la base de datos, que contienen
los recursos que pueden solicitarse o ACO's (\textsl{Access Control
Object}) contenidos en la tabla \textsl{acos}, los objetos que pueden
solicitar el control de algún recurso o ARO's (\textsl{Access Request
Object}) contenidos en la tabla \textsl{aros}, y las relaciones entre
ellos contenidas en la tabla \textsl{aros\_acos}.

CakePHP permite la creación de estas tablas de dos maneras:
\begin{itemize}
\item La primera, mediante la cónsola de CakePHP, utilizando el el siguiente
comando:

\begin{itemize}
\item \textsl{\$ cake schema run create DbAcl}
\end{itemize}
\item La otra manera, es ejecutando un script de SQL, que contiene las tablas
a ser creadas. Este script se encuentra en los archivos de configuración
de CakePHP.
\end{itemize}
~

Luego de tener las tablas necesarias, se procede a definir los ARO's
y ACO's de la aplicación. Los ARO's se definieron en la tabla \textsl{groups},
que contiene los tipos de usuarios que pertenecen al sistema. Se desarrolló
una función que se utilizó para crear los ARO's basados en los tipos
de usuarios contenidos en \textsl{groups}, agregándolos a la tabla
\textsl{aros}.

Luego, se debe construir la tabla \textsl{acos}, para lo cual, se
utilizó una función denominada \textsl{buildAcl()}, encontrada en
el \textsl{Cookbook} de CakePHP, y diseñada para tal fin \cite{build_Acl}. 

Ya pobladas ambas tablas, se procede a conceder los permisos de utilizar
los ACO's que requiere cada uno de los ARO's. Se utilizan las funciones
deny() y allow(), del componente ACL de CakePHP, para asignar o denegar
permisos de un recurso a un tipo de usuario en particular.


\subsubsection{Primera Iteración: Pruebas Unitarias.}

Para cada uno de los módulos desarrollados en esta iteración, se realizaron
un conjunto pequeño de pruebas para verificar el buen funcionamiento
de las funcionalidades desarrolladas. En los módulos de registro de
pacientes y usuarios, y el módulo de gestión de usuarios, se realizó
treinta (30) inserciones de prueba mediante la aplicación, para verificar
si los datos se registraban correctamente a nivel de datos. También,
se colocó ciertas restricciones de valores en los campos de los formularios,
como el login de usuario en caso de no ser paciente, debe contener
al menos un caracter no-numérico, y se verificó que estas restricciones
se cumplieran a cabalidad.

Con el módulo de inicio de sesión, se realizaron pruebas de ingreso
al sistema utilizando contraseñas erróneas, verficándose que sólo
se puede acceder como un usuario si se ingresa este valor de manera
correcta. También, se verificó que el valor de la contraseña cifrada
se almacenara correctamente.

En cuanto a las Listas de Control de Acceso, se definieron permisos
para cierto grupo de usuarios, y luego se intentó acceder tanto a
los recursos que se permitía acceder, como aquellos que no, verificando
que el esquema de ACL funcionaba de la manera esperada.


\subsection{Segunda Iteración: Gestión de Consultas Médicas.}

En esta iteración se tiene como objetivo el desarrollo de todas las
actividades necesarias para llevar a cabo una consulta médica. En
esta etapa, se hace visible la necesidad de elementos dinámicos, que
requieren actualización de datos asíncronamente, por lo tanto se utiliza
la técnica AJAX, y jQuery, para enviar los datos recogidos en los
formularios al servidor. También, se decidió realizar todas las operaciones
realizables en una consulta, en una sola vista, y desplegando con
jQuery, las secciones de interés, mediante la interacción con el menú
y los formularios.


\subsubsection{Diseño e implementación de módulo de registro de antecedentes y hábitos.}

Es necesario registrar los antecedentes médicos del paciente, para
esto se diseñó un formulario con la información referida a los antecedentes
médicos personales, familiares y los hábitos del paciente.

La información recogida en este formulario, es almacenada en la base
de datos, en las tablas\textsl{ antecedentes\_medicos} y \textsl{habitos},
en formato JSON (\textsl{Javascript Object Notation}).

En las Figura 4.8 y 4.9, se presentan los formulario de registro de
Antecedentes Personales y Antecedentes Familiares respectivamente.

\begin{center}
\begin{figure}[h]
\centering{}\includegraphics[scale=0.27]{\string"Imagenes Expo/antecedentesPersonales\string".eps}\caption{Formulario de Antecedentes Personales}
\end{figure}

\par\end{center}

\begin{center}
\begin{figure}[h]
\centering{}\includegraphics[scale=0.27]{\string"Imagenes Expo/antecedentesFamiliares\string".eps}\caption{Formulario de Antecedentes Familiares}
\end{figure}

\par\end{center}

~

Al iniciar una consulta, se verifica si el paciente ya posee datos
de antecedentes médicos, y si es así, estos son cargados en la interfaz
de la consulta. El médico puede entonces modificarlos si es necesario.


\subsubsection{Diseño e implementación de módulo de prescripción de medicamentos.}

Se debe poder prescribir medicamentos a un paciente. Para realizar
esta función, se determinó la información importante a indicar sobre
un tratamiento asignado a un paciente. Se requiere indicar qué medicamento
o tratamiento se prescribirá, cuál es la presentación del medicamento,
qué concentración se necesita, qué dosis se administrará, la duración
del tratamiento y el horario en que se debe administrar. 

Para indicar esta información, se diseñó un formulario dinámico, al
seleccionar el campo Tratamiento, se despliega un pop-up que permite
escoger uno de los tratamientos, luego se van habilitando uno a uno
los campos siguientes para seleccionar el resto de los datos. Al completar
un tratamiento, se genera una nueva entrada en el formulario. 

En la figura 4.10, se aprecia el formulario dinámico de Tratamientos.
En la figura 4.11, se presenta el pop-up de búsqueda de tratamientos
presentes en el sistema.

\begin{center}
\includegraphics[scale=0.26]{\string"Imagenes Expo/tratamientos\string".eps}
\begin{figure}[h]
\caption{Formulario de Prescripción de Tratamientos.}
\end{figure}

\par\end{center}

\begin{center}
\includegraphics[scale=0.26]{\string"Imagenes Expo/tratamientosPopUp\string".eps}
\begin{figure}[h]
\caption{Pop-up de búsqueda de tratamientos en el sistema.}
\end{figure}

\par\end{center}

Esto permite agregar diferentes tratamientos en una sola consulta.
Además, existe una sección para agregar tratamientos que no están
almacenados entre los seleccionables en la base de datos.


\subsubsection{Construcción de módulo de exámenes funcionales, físicos y paraclínicos.}

Se necesita almacenar información de los exámenes funcionales, físicos
y paraclínicos que se evaluan en una consulta. Para cada tipo de examen,
se desarrolló un formulario. Estos formularios, son almancenados en
la base de datos, en formato JSON, el uso de este formato se debe
a la variabilidad que es un formato que permite agregar nuevas preguntas
al formulario, sin requerir modificaciones en el modelo de datos,
lo que simplifica los posibles cambios a cada uno de los exámenes.
Se determinaron un conjunto de preguntas, cada una numerada con un
identificador, y luego, se almacenan en la tabla correspondiente.

A continuación, se presenta el formulario de exámenes funcionales.
(Figura 4.12).

\begin{center}
\begin{figure}[h]
\centering{}\includegraphics[scale=0.27]{\string"Imagenes Expo/funcional\string".eps}\caption{Formulario de Exámenes Funcionales.}
\end{figure}

\par\end{center}

En la figura 4.13 y 4.14, se observan vistas del formulario de exámenes
físicos.

\begin{center}
\begin{figure}[H]
\centering{}\includegraphics[scale=0.27]{\string"Imagenes Expo/físico\string".eps}\caption{Formulario de Exámenes Físicos (Signos Vitales).}
\end{figure}

\par\end{center}

\begin{center}
\begin{figure}[H]
\centering{}\includegraphics[scale=0.27]{\string"Imagenes Expo/fisico2\string".eps}\caption{Formulario de Exámenes Físicos (Resto).}
\end{figure}

\par\end{center}


\subsubsection{Construcción de módulo de interconsultas.}

En la consulta médica, es necesario poder referir al paciente a evaluación
con otro profesional del área de la salud, en caso que sea necesario.
Para ésto, se diseñó un módulo para interconsultas, que consiste en
un formulario que genera campos dinámicamente, a medida que se van
registrando cada una de las interconsultas. El médico selecciona la
la especialidad de la interconsulta, luego, indica el motivo de la
misma. Al finalizar, se genera automáticamente un nuevo campo de interconsultas,
en caso de que se requiera agregar otra. Para cada interconsulta almacenada,
es posible generar un documento imprimible en formato PDF, que contenga
los datos del paciente, los datos del médico que refiere al paciente
y la información de la interconsulta requerida. Este documento es
generado, utilizando una librería escrita en PHP denominada TCPDF,
la cual es una clase de PHP diseñada para generar documentos en formato
PDF, desarrollada por Nicola Asuni y publicada en el sitio Web del
proyecto. 

A continuación, se muestra el formulario de interconsultas en la figura
4.15.

\begin{center}
\includegraphics[scale=0.3]{img/Interconsulta}
\begin{figure}[h]
\caption{Formulario de Interconsultas.}
\end{figure}

\par\end{center}

En la figura 4.16, se presenta una muestra del documento de interconsultas
generado por el sistema.

\begin{center}
\includegraphics[scale=0.3]{img/DocumentoInter}
\begin{figure}[h]
\caption{Documento PDF de Interconsultas generado por el sistema.}
\end{figure}

\par\end{center}


\subsubsection{Diseño e implementación de módulo de solicitud de citas de laboratorio
con Venelab.}

Uno de los requerimientos más importantes del proyecto, era la posibilidad
realizar una solicitud de perfiles y exámenes de laboratorio desde
una consulta médica que está siendo atendida, y comunicar dicha solicitud
al laboratorio Venelab. Para esto, se diseñó un módulo de selección
de exámenes y perfiles a solicitar, y un sistema de solicitud de citas,
utilizando correo electrónico.

En la Figura 4.17, se presenta el formulario de solicitud de citas
de laboratorio.

\begin{center}
\includegraphics[scale=0.3]{img/CitaVenelab}
\begin{figure}[h]
\caption{Formulario de Solicitud de Citas de Laboratorio.}
\end{figure}

\par\end{center}

El médico, selecciona los perfiles a realizar, de manera similar a
la selección de tratamientos descrita anteriormente, luego, debe consultar
al paciente si desea que se envíe una solicitud de cita de laboratorio
al sistema Venelab. Si la respuesta es afirmativa, selecciona la opción
de solicitar cita, y se enviará un correo electrónico al laboratorio
Venelab, que contiene la información básica necesaria para contactar
al paciente, y además, los exámenes y perfiles de laboratorio solicitados
por el médico. Luego, queda de parte del laboratorio Venelab, contactar
al paciente para la confirmación de la consulta, y el horario a convenir.

En la Figura 4.18, se aprecia un ejemplo del correo electrónico recibido
por Venelab, con la información del paciente y de los exámenes a realizarse.

\begin{center}
\includegraphics[scale=0.3]{img/CorreoSolicitud}
\begin{figure}[h]
\caption{Ejemplo de Correo Electrónico recibido por Venelab.}
\end{figure}

\par\end{center}


\subsubsection{Diseño e implementación de módulo de carga de archivos e imágenes.}

Era importante definir un método para almacenar documentos. Estos
documentos pueden ser exámenes médicos digitalizados, en formatos
de imagen (jpeg, png, gif) o archivos de texto (pdf). Se almacenan
en el servidor, pudiendo ser accedidos desde una consulta. En la base
de datos, se almacenan las url correspondientes a cada archivo, y
una descripción y observaciones sobre los mismos. 

En la Figura 4.19, se presenta una captura del módulo de carga de
archivos e imágenes.

\begin{center}
\includegraphics[scale=0.3]{\string"Imagenes Expo/ExámenesArchivos\string".eps}
\begin{figure}[h]
\caption{Módulo de Carga de Archivos e Imágenes.}
\end{figure}

\par\end{center}


\subsubsection{Construcción de módulo de diagnósticos.}

En una consulta, se requiere que el médico pueda asignar diagnósticos
al paciente. Para esto se realizó un formulario que permite seleccionar
diagnósticos que estén presentes en la lista de patologías existentes
en la base de datos, como tambie\'{n}, agregar diagnósticos manualmente,
en caso de que no estén presentes en la lista. Se realiza de manera
similar a la selección de tratamientos:

El médico selecciona el campo \textsl{Patología} del formulario, al
hacer esto, se despliega un pop-up, que posee un campo de búsqueda
para filtrar las patologías y una lista de patologías seleccionables.
Al escoger la patología, se cargan la información de la misma en el
formulario y se habilita el campo de \textsl{Especificación}, para
que el médico pueda agregar detalles de la patología para el paciente.

A continuación, se muestra el formulario de diagnóstico de patologías.
(Figura 4.20). En la Figura 4.21, se presenta el pop-up de búsqueda
de diagnósticos.

\begin{center}
\includegraphics[scale=0.25]{\string"Imagenes Expo/Diagnosticos\string".eps}
\begin{figure}[h]
\caption{Formulario de Diagnósticos.}
\end{figure}

\par\end{center}

\begin{center}
\includegraphics[scale=0.25]{\string"Imagenes Expo/DiagnosticoPopup\string".eps}
\begin{figure}[h]
\caption{Pop-up de búsqueda de diagnósticos.}
\end{figure}

\par\end{center}

Si se debe agregar una patología manualmente, se debe dirigir al área
de \textsl{Otros Diagnósticos}, donde se presenta un formulario similar,
pero al seleccionar el campo de patologías, se puede agregar texto
libremente, al hacer ésto, se habilita el campo Sistema, para definir
a qué sistema físico pertenece la patología, y luego se habilita el
campo de \textsl{Especificación.}


\subsubsection{Segunda Iteración: Pruebas Unitarias.}

Para esta iteración, se realizó un conjunto de pruebas sencillas,
para verificar que los módulos desarrollados ejecutan su tarea de
la manera esperada. En ese sentido, se siguió las siguientes acciones:

Para las tablas que se almacenan en formato JSON (\textsl{antecedentes\_medicos},
\textsl{habitos}, \textsl{examenes\_funcionales}, examenes\_fisicos,
examenes\_paraclinicos), se realizó pruebas de inserción de datos
en la base de datos, con la finalidad de verificar que se estuvieran
almacenando en el formato correcto.

Algunos campos de los formularios, requerían validaciones y restricciones,
como los que solo permiten valores numéricos, entre otros. Se realizaron
validaciones a nivel del cliente y del servidor, y se realizaron inserciones
para verificar que se cumplían las restricciones.

En los formularios dinámicos, como el de Diagnósticos o Tratamientos,
se verificó que cada uno de los diagnósticos ingresados en los formularios
fuera almancenado en la base de datos, o retornara el error esperado,
en caso de ocurrir algún problema.

Para la sección de solicitud de citas de laboratorio, se enviaron
gran cantidad de solicitudes (entre 25 y 30 solicitudes), con la finalidad
de verificar que se enviaban correctamente los correos electrónicos,
y que además, contenían la información necesaria de los pacientes.

En cuanto a la generación de documentos de interconsultas para su
impresión, se crearon diferentes interconsultas y se generaron los
documentos PDF, para verificar si contenían la información correcta
del paciente y del médico asociados a la misma.


\subsection{Tercera Iteración: Generación de Reportes y Visualización de Consultas.}

La última iteración corresponde a la generación de informes médicos,
reportes de patologías recurrentes, y la visualización y edición de
las consultas existentes en el sistema.


\subsubsection{Diseño e implementación de módulo de Generación de Informes de Consultas.}

Al finalizar una consulta, el médico necesita generar un informe médico,
con la información recolectada en el desarrollo de la consulta. Esta
tarea se realizaba manualmente, por el doctor, mediante un procesador
de texto. En la consulta recogía la información, y luego, se redactaban
los informes. La idea de esta función es automatizar este procedimiento,
mediante la recopilación de la información obtenida con el sistema,
y con esta, construir el informe. Para la construcción de los informes
se emplea la librería TCPDF, utilizada previamente para generar los
documentos de interconsultas.

Se solicita la creación del informe, el servidor consulta los datos
de la consulta, incluyendo datos del paciente, y del médico que la
atiende, son enviados a una vista en formato JSON o en arreglos de
PHP, luego, son procesados y se van armando los bloques de información
en formato HTML. Al final, con las funciones que provee TCPDF para
construir los documentos, se agrega la información procesada y se
genera el archivo PDF.

A continuación, se aprecia un ejemplo de Informe Médico generado por
el sistema. (Figura 4.22).

\begin{center}
\includegraphics[scale=0.3]{img/InformeGenerado}
\begin{figure}[h]
\caption{Informe Médico Generado por la Aplicación (PDF).}
\end{figure}

\par\end{center}


\subsubsection{Diseño e implementación de módulo de reporte de patologías recurrentes.}

La segunda etapa de la tercera iteración consiste en el desarrollo
de un módulo de reporte de patologías recurrentes. Este módulo debe
mostrar de manera visual, utilizando gráficos de barra, o de linea,
la ocurrencia de patologías. Se definieron diversos filtros al momento
de realizar las consultas. 

Se puede consultar seleccionando o no una patología específica; si
no se selecciona una patología específica, se retornará la información
de la ocurrencia de diagnósticos por sistemas en un gráfico de barras;
si se selecciona una patología, se mostrará la ocurrencia de diagnósticos
para dicha patología.

En la Figura 4.23, se muestra el formulario de patologías recurrentes.

\begin{center}
\includegraphics[scale=0.27]{img/FormularioPatologías}
\begin{figure}[h]
\caption{Formulario de Patologías Recurrentes.}
\end{figure}

\par\end{center}

Esta información puede filtrarse por edades, existiendo 9 categorías:
Recién Nacido (0 - 28 días), Lactante Menor (29 días - 12 meses),
Lactante Mayor (12 - 24 meses), Preescolar (2 - 6 años), Escolar (7
- 11 años), Adolescente (12 - 19 años), Adulto Joven (20 - 39 años),
Adulto Maduro (40 - 64 años) y Adulto Mayor (65 años en adelante).
También, se pueden aplicar filtros por fecha, por rangos de fechas.

En la Figura 4.24, se presentan los filtros de búsqueda por edades
y sexo, para las patologías recurrentes.

\begin{center}
\includegraphics[scale=0.27]{img/PAtologías}
\begin{figure}[h]
\caption{Filtro de búsqueda por rangos de edades y sexo.}
\end{figure}

\par\end{center}

Si se selecciona una patología específica, también se puede seleccionar
como mostrar la información: por meses, trimestres, semestres, años,
o combinaciones mes/año, trimestre/año, semestre/año.

Esto se desarrolla utilizando una librería denominada \textsl{Open
Flash Chart} 2, que proporciona una interfaz con funciones para generar
gráficos estadísticos en SWF (\textsl{Shockwave Flash}), desarrollada
en PHP, la cual es software libre bajo la licencia LGPL, y un \textsl{Helper}
de CakePHP, que integra las librerías con el \textsl{framework} utilizado.

En la Figura 4.25, se presentan diferentes ejemplos de estadísticas
mostradas por la aplicación, dependiendo de los filtros de búsqueda
aplicados en la consulta.

\begin{center}
\begin{figure}[H]
\begin{centering}
\includegraphics[scale=0.23]{img/Patologia3}\includegraphics[scale=0.2]{img/Patologias}
\par\end{centering}

\begin{centering}
\includegraphics[scale=0.23]{img/Patologia2}\includegraphics[scale=0.23]{\string"Imagenes Expo/RecurreciaAnualMes\string".eps}
\par\end{centering}

\caption{Estadísticas de Patologías Generadas por el sistema.}
\end{figure}

\par\end{center}


\subsubsection{Construcción de módulo de visualización y edición de consultas previas.}

La última actividad de la tercera iteración contempla el desarrollo
de un módulo para visualización y edición de consultas previas. Este
se realiza, básicamente, utilizando una vista similar a la desarrollada
para la gestión de consultas, luego, se deben cargar todos los datos
relacionados a la consulta a editar, en los formularios ya existentes.
En el servidor, se realizan todas las consultas de la base de datos,
y esos datos se envían a la vista. Luego, mediante el uso de jQuery,
se rellenan los formularios y se generan todos los contenidos dinámicos
necesarios.

En la figura 4.26, se aprecia el inicio del módulo de edición de consultas
médicas.

\begin{figure}[H]


\begin{centering}
\includegraphics[scale=0.35]{\string"Imagenes Expo/EditarConsulta\string".eps}\caption{Formulario de Edición de Consultas Médicas}

\par\end{centering}

\end{figure}



\subsubsection{Tercera Iteración: Pruebas Unitarias.}

Para finalizar el desarrollo de la aplicación, se aplicó un conjunto
de pruebas unitarias para verificar el correcto funcionamiento de
los módulos desarrollados. En cuanto a la generación de Informes Médicos,
se creó un conjunto de veinte (20) consultas médicas, y se verificó
que los datos que eran presentados en el informe médico, correspondían
con los existentes en cada consulta. Con respecto a los reportes estadísticos,
se realizaron consultas en la base de datos a fin de corroborar que
los datos retornados gráficamente, se correspondían con los filtros
utilizados en la búsqueda y con los datos presentes en la base de
datos. 

El módulo de edición y visualización de consultas previas, al ser
básicamente, una adaptación de los formularios ya existentes para
la creación de consultas, y que utiliza las mismas funciones para
insertar datos en la base de datos, sólo requirió probar que los datos
cargados en la vista, correspondían a los datos presentes asociados
a la consulta a modificar.


\section{Transición}

Esta fase comprende la ejecución de pruebas para determinar el correcto
funcionamiento de la aplicación. Estas pruebas tienen como finalidad
asegurar la calidad, mediante la búsqueda de errores, tanto de programación
como de configuración, la validación del funcionamiento apropiado
del sistema y verificación de que los requerimientos iniciales fueron
satisfechos. También comprende la fase de despliege o puesta en producción
de la aplicación, sin embargo, como se menciona previamente, esta
fase no estaba considerada como parte del proyecto de pasantías a
desarrollar.

La mayoría de las verificaciones realizadas se relacionaron al modelo
de datos, verificando que las inserciones en la base de datos se hicieran
de manera correcta, sobre todo, en las tablas donde se utilizó el
formato JSON para almacenar los datos. También, verificaciones de
integridad del funcionamiento de las vistas y operaciones del controlador,
en caso de variables que no tienen valor, o son nulas, o se debe retornar
mensajes de error.

Sin embargo, el sistema actualmente no ha sido sometido a pruebas
rigurosas. Se espera que estas pruebas se ejecuten al momento de preparar
la aplicación para ser desplegada o puesta en producción.


\section{Balance Final}

En la construcción de la aplicación, se implementó un conjunto de
módulos que satisfacen las necesidades detectadas en las fases de
Inicio y Elaboración. A continuación, se presenta un balance de los
mismos.

En la primera iteración, se desarrollaron cinco (5) actividades relacionadas
a cuatro (4) módulos, asociados al registro y gestión de usuarios
del sistema. Estos módulos, cumplen con los casos de uso de \textsl{Iniciar
Sesión, Registrar Médico, Registrar Paciente, Manejar Datos Paciente,
Consultar Datos Paciente, Modificar Datos Paciente, Autenticar Usuario,
Registrar Usuario, Cambiar Contraseña y Cerrar Sesión}. Estos CU se
ejecutaron en su totalidad.

Para la segunda iteración, se implementaron siete (7) módulos, que
formaban parte de las actividades de gestión de consultas médicas.
Estos módulos cubren los siguientes casos de uso: \textsl{Gestionar
Consulta, Consultar Historial Médico, Registrar Consulta Médica, Prescribir
Medicamentos, Añadir Antecedentes, Referir Interconsulta Paciente
y Solicitar Cita Laboratorio}. Todos los casos de uso mencionados
se ejecutan al 100\%, excepto \textsl{Consultar Historial Personal}
y \textsl{Gestionar Consulta}, que requieren la generación de los
informes médicos. Sin embargo, estas tareas se finalizan en la tercera
iteración. 

La última iteración comprende tres (3) módulos, que se encargan de
las actividades de visualización de resultados, reportes estadísticos
y generación de informes médicos. Esta iteración aborda los casos
de uso \textsl{Generar Reportes Estadísticos} y \textsl{Generar Informe
Médico}, y además finaliza el desarrollo de \textsl{Consultar Historial
Personal} y \textsl{Gestionar Consulta. }

Se plantearon en principio, veinte (20) casos de uso, y se cumplió
con la totalidad de los mismos, aún cuando, el objetivo del proyecto
de pasantías estipulaba un cumplimiento de al menos 80\% a nivel de
CU. 

En la aplicación, se tomaron en cuenta consideraciones de seguridad,
para evitar el acceso de usuarios no autorizados a operaciones que
no le corresponden, mediante CakePHP, y sus Componentes \textsl{Acl}
y \textsl{Auth}, los cuales permiten la creación de esquemas de acceso
según grupos de usuarios, y además, la validación mediante contraseñas
con cifrado.

En el alcance del proyecto, no se contempla el despliege de la aplicación,
al ser como objetivo de éste, la entrega de un prototipo, 80\% funcional.
Tampoco se incluyó en el alcance del proyecto la implementación de
una interfaz gráfica definitiva.

\newpage{}
